machine:
  services:
    - docker
  python:
    version: 2.7
  environment:
    COVERALLS_REPO_TOKEN: RDQpf8yX7quK5FXKN2auJpAxFNlIByLiT


dependencies:
  pre:
    - pip install --use-mirrors coverage python-coveralls nose

test:
  override:
    - mkdir test_dir
    - cd test_dir && COVERAGE_FILE=../.coverage.init coverage run ../ctf-cli.py init
    - cd test_dir && COVAREGE_FILE=../.coverage.remote_add coverage run ../ctf-cli.py remote add features https://github.com/Containers-Testing-Framework/common-features.git
    - cd test_dir && COVERAGE_FILE=../.coverage.update coverage run ../ctf-cli.py update
    - cd test_dir && COVERAGE_FILE=../.coverage.run coverage run ../ctf-cli.py run
    - COVERAGE_FILE=.coverage.tests nosetests
    - coverage combine
    - coveralls

notify:
  webhooks:
    - url: https://webhooks.gitter.im/e/92b168ffacdc38a6facd
